var exec = require("child_process").exec;
var defaultValue = -50;

module.exports = {
    getTemperature: function(deviceId, callback) {
    	try{
	        var child = exec("cat /sys/bus/w1/devices/" + deviceId + "/w1_slave", function (error, stdout, stderr) {
	        	if(stdout != null){
		            var tempData = stdout.toString().split('\n')[1];
		            if(tempData != null){
			            var temp = parseInt(tempData.split("=")[1]) / 1000;
			            callback(null, temp);
		            }else{
		            	callback('Temp value is null', defaultValue);
		            }
	        	}else{
	        		callback('stdout is null', defaultValue);
	        	}
	        });
    	}catch(e){
    		log.error(e);
    		callback(e, defaultValue);
    	}
    }
}